<p-dialog *ngIf="selectedUserId" [draggable]="false" [(visible)]="patientHistoryModal" [modal]="true"
    (onHide)="handleHideModal()" [style]="{ minWidth: '550px' }">
    <ng-container *ngIf="selectedUserId">
        <patient-history-detail [userId]="selectedUserId" />
    </ng-container>
</p-dialog>

<div class="screen">
    <div style="width: 100%; padding: 0 50px;">


        <div class="action-header">
            <div style="display: flex; align-items: center; gap: 8px;">
                <arrow-back />
                <h1>Mis pacientes</h1>
            </div>
        </div>


        <div class="users-grid" *ngIf="allUsers.length">

            <div class="user-card" *ngFor="let user of allUsers">

                <div>
                    <img [src]="user.attachedImage" alt="user-image">
                </div>

                <div class="detail">
                    <div class="name">{{ user.firstName + ' ' + user.lastName }}</div>
                    <div>{{ user.email }}</div>
                    <div>{{ user.healthcare ?? '-' }}</div>
                    <button class="action-button" pButton (click)="handlePatientHistoryModal(user)">
                        Ver historia clinica
                    </button>
                </div>

            </div>
        </div>

        <div class="users-grid" *ngIf="!allUsers.length" style="color: #589bec;">
            <h2>No hay usuarios disponibles</h2>
        </div>

        <!-- <div style="max-height: 520px; overflow-y: scroll;">

            <p-table [value]="allUsers" [tableStyle]="{ 'min-width': '50rem', 'max-height': '550px' }">
                <ng-template pTemplate="header">
                    <tr>
                        <th>Nombre</th>
                        <th>Apellido</th>
                        <th>Correo</th>
                        <th>Obra social</th>
                        <th>Acciones</th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-user>
                    <tr>
                        <td>{{ user.firstName }}</td>
                        <td>{{ user.lastName }}</td>
                        <td>{{ user.email }}</td>
                        <td>{{ user.healthcare ?? '-' }}</td>
                        <td *ngIf="user.healthcare">
                            <button class="action-button" pButton (click)="handlePatientHistoryModal(user)">
                                Ver historia clinica
                            </button>
                        </td>
                    </tr>
                </ng-template>

                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td *ngIf="getUsersLoading" colspan="7">
                            <div class="loading-table-container">
                                Cargando...
                                <i class="pi pi-spin pi-spinner"></i>
                            </div>
                        </td>
                        <td *ngIf="!getUsersLoading" colspan="7">No se encontraron usuarios</td>
                    </tr>
                </ng-template>
            </p-table>

        </div> -->


    </div>
</div>